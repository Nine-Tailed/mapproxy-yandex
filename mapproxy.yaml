services:
  tms:
    use_grid_names: true
    origin: 'nw'
  demo:
    md:
      title: Yandex Proxy
      abstract: Прокси для тайлов Яндекса в WGS84

layers:
  - name: yandex
    title: Yandex Maps (WGS84)
    sources: [yandex_cache]

caches:
  yandex_cache:
    sources: [yandex_source]
    grids: [wgs84_grid]
    cache:
      type: file
      directory: /var/cache/mapproxy
      directory_layout: tms

sources:
  yandex_source:
    type: tile
    url: https://core-renderer-tiles.maps.yandex.net/tiles?l=map&x=%(x)s&y=%(y)s&z=%(z)s
    http:
      headers:
        User-Agent: "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36"
        Referer: "https://yandex.ru/maps/"
    grid: web_mercator

grids:
  web_mercator:
    base: GLOBAL_MERCATOR
  wgs84_grid:
    srs: 'EPSG:4326'
    bbox: [-180, -90, 180, 90]
    num_levels: 20